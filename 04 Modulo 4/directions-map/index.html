<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps Directions Demo - Rutas Avanzadas</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />

    <!-- 
    üîë CONFIGURACI√ìN DE API KEY DE GOOGLE MAPS:
    
    Para que funcione este demo, necesitas:
    
    1. üìù Obtener una API Key:
       - Ve a https://console.cloud.google.com/
       - Crea un proyecto o selecciona uno existente
       - Ve a "APIs & Services" > "Credentials"
       - Crea una nueva API Key
    
    2. üîí Configurar restricciones de seguridad:
       - Selecciona tu API key
       - En "Application restrictions" selecciona "HTTP referrers"
       - Agrega: localhost:3000/*, tu-dominio.com/*
    
    3. üõ†Ô∏è Habilitar APIs necesarias:
       - Maps JavaScript API
       - Directions API  
       - Places API
       - Traffic Layer API (opcional, para tr√°fico en tiempo real)
    
    4. ‚úèÔ∏è Reemplazar la clave:
       - Busca "TU_API_KEY_AQUI" en este archivo
       - Reempl√°zala con tu clave real
    -->
</head>

<body>
    <div class="container">
        <!-- ======================================== -->
        <!-- üéõÔ∏è PANEL DE CONTROL (IZQUIERDA) -->
        <!-- ======================================== -->
        <div class="control-panel">
            <h1>üó∫Ô∏è Demo de Rutas Google Maps</h1>

            <!-- üìç CONFIGURACI√ìN B√ÅSICA DE RUTA -->
            <div class="route-config">
                <div class="input-group">
                    <label for="origin">Origen:</label>
                    <!-- üîç Autocomplete de Google Places para ciudades mexicanas -->
                    <input type="text" id="origin" placeholder="Ciudad de origen..." />
                </div>

                <div class="input-group">
                    <label for="destination">Destino:</label>
                    <!-- üîç Autocomplete de Google Places para ciudades mexicanas -->
                    <input type="text" id="destination" placeholder="Ciudad de destino..." />
                </div>
            </div>

            <!-- üõë PARADAS INTERMEDIAS (WAYPOINTS) -->
            <div class="waypoints-section">
                <h3>Paradas Intermedias</h3>
                <!-- üìç Lista din√°mica de waypoints (se llena con JavaScript) -->
                <div id="waypoints-list"></div>
                <!-- ‚ûï Bot√≥n para agregar nuevas paradas (m√°ximo 8) -->
                <button id="add-waypoint" class="btn btn-secondary">+ Agregar Parada</button>
            </div>

            <!-- ‚öôÔ∏è OPCIONES AVANZADAS DE RUTA -->
            <div class="route-options">
                <h3>Opciones de Ruta</h3>

                <!-- üéØ OPTIMIZACI√ìN DE WAYPOINTS -->
                <div class="option-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="optimize-waypoints" checked>
                        <span class="checkmark"></span>
                        Optimizar orden de paradas
                        <!-- ‚≠ê CLAVE: Google Maps reorganiza autom√°ticamente las paradas para la ruta m√°s eficiente -->
                    </label>
                </div>

                <!-- üöß EVITAR PEAJES -->
                <div class="option-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="avoid-tolls">
                        <span class="checkmark"></span>
                        Evitar peajes
                    </label>
                </div>

                <!-- üõ£Ô∏è EVITAR AUTOPISTAS -->
                <div class="option-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="avoid-highways">
                        <span class="checkmark"></span>
                        Evitar autopistas
                    </label>
                </div>

                <!-- üöó MODO DE VIAJE -->
                <div class="option-group">
                    <label for="travel-mode">Modo de viaje:</label>
                    <select id="travel-mode">
                        <option value="DRIVING">üöó Conducir</option>
                        <option value="WALKING">üö∂ Caminar</option>
                        <option value="TRANSIT">üöå Transporte p√∫blico</option>
                        <option value="BICYCLING">üö¥ Bicicleta</option>
                    </select>
                </div>
            </div>

            <!-- üöÄ BOTONES DE ACCI√ìN PRINCIPALES -->
            <div class="action-buttons">
                <!-- üéØ Bot√≥n principal: Calcula la ruta con todas las opciones -->
                <button id="calculate-route" class="btn btn-primary">Calcular Ruta</button>
                <!-- üîÑ Bot√≥n: Muestra rutas alternativas si est√°n disponibles -->
                <button id="show-alternatives" class="btn btn-secondary">Ver Alternativas</button>
                <!-- üóëÔ∏è Bot√≥n: Limpia la ruta actual y resetea la interfaz -->
                <button id="clear-route" class="btn btn-danger">Limpiar</button>
            </div>

            <!-- ‚õΩ CONFIGURACI√ìN DE COMBUSTIBLE -->
            <div class="fuel-config">
                <h3>Configuraci√≥n de Combustible</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label for="fuel-efficiency">Eficiencia (km/L):</label>
                        <!-- üöó Eficiencia del veh√≠culo para calcular consumo -->
                        <input type="number" id="fuel-efficiency" value="12" min="1" max="50">
                    </div>
                    <div class="input-group">
                        <label for="fuel-price">Precio por litro ($):</label>
                        <!-- üí∞ Precio del combustible para calcular costo total -->
                        <input type="number" id="fuel-price" value="25" min="1" step="0.1">
                    </div>
                </div>
            </div>
        </div>

        <!-- ======================================== -->
        <!-- üìä PANEL DE RESULTADOS (DERECHA) -->
        <!-- ======================================== -->
        <div class="results-panel">
            <!-- üìà M√âTRICAS PRINCIPALES DE LA RUTA -->
            <div class="route-metrics" id="route-metrics" style="display: none;">
                <h3>Resumen de Ruta</h3>
                <div class="metrics-grid">
                    <!-- üìè Distancia total (suma de todos los legs) -->
                    <div class="metric">
                        <span class="metric-label">Distancia:</span>
                        <span class="metric-value" id="total-distance">-</span>
                    </div>
                    <!-- ‚è∞ Tiempo total (con o sin tr√°fico) -->
                    <div class="metric">
                        <span class="metric-label">Tiempo:</span>
                        <span class="metric-value" id="total-duration">-</span>
                    </div>
                    <!-- ‚õΩ Costo estimado de combustible -->
                    <div class="metric">
                        <span class="metric-label">Costo combustible:</span>
                        <span class="metric-value" id="fuel-cost">-</span>
                    </div>
                </div>
            </div>

            <!-- üîÑ RUTAS ALTERNATIVAS -->
            <div class="alternatives-section" id="alternatives-section" style="display: none;">
                <h3>Rutas Alternativas</h3>
                <!-- üìç Lista de rutas alternativas (se llena con JavaScript) -->
                <div id="alternatives-list"></div>
            </div>

            <!-- üìã INSTRUCCIONES TURN-BY-TURN -->
            <div class="directions-panel" id="directions-panel" style="display: none;">
                <h3>Instrucciones de Ruta</h3>
                <!-- üó∫Ô∏è Instrucciones detalladas paso a paso (se llena con JavaScript) -->
                <div id="directions-list"></div>
            </div>

            <!-- üí¨ MENSAJES DE ESTADO Y ERRORES -->
            <div class="status-messages" id="status-messages"></div>
        </div>

        <!-- ======================================== -->
        <!-- üó∫Ô∏è MAPA PRINCIPAL (CENTRO) -->
        <!-- ======================================== -->
        <div class="map-container">
            <!-- üó∫Ô∏è Instancia de Google Maps (se inicializa con JavaScript) -->
            <div id="map"></div>
            <!-- ‚è≥ Overlay de carga mientras se calcula la ruta -->
            <div class="loading-overlay" id="loading-overlay" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Calculando ruta...</p>
            </div>
        </div>
    </div>

    <!-- ======================================== -->
    <!-- üåê CARGA DE GOOGLE MAPS API -->
    <!-- ======================================== -->
    <script>
        // üîë CONFIGURACI√ìN DE API KEY
        // ‚ö†Ô∏è IMPORTANTE: Reemplaza con tu clave real de Google Maps
        const GOOGLE_MAPS_API_KEY="<Dummy-API-Key>";

        // üìö CARGAR GOOGLE MAPS API CON LIBRER√çAS NECESARIAS
        // Este script carga autom√°ticamente las librer√≠as que necesitamos:
        // - maps: Mapa principal
        // - places: Autocomplete de lugares
        // - geometry: C√°lculos geom√©tricos
        (g => {
            var h, a, k, p="The Google Maps JavaScript API", c="google", l="importLibrary", q="__ib__", m=document, b=window;
            b=b[c]||(b[c]={});
            var d=b.maps||(b.maps={}), r=new Set, e=new URLSearchParams, u=() => h||(h=new Promise(async (f, n) => {
                await (a=m.createElement("script"));
                e.set("libraries", [...r]+"");
                for(k in g) e.set(k.replace(/[A-Z]/g, t => "_"+t[0].toLowerCase()), g[k]);
                e.set("callback", c+".maps."+q);
                a.src=`https://maps.${c}apis.com/maps/api/js?`+e;
                d[q]=f;
                a.onerror=() => h=n(Error(p+" could not load."));
                a.nonce=m.querySelector("script[nonce]")?.nonce||"";
                m.head.append(a)
            }));
            d[l]? console.warn(p+" only loads once. Ignoring:", g):d[l]=(f, ...n) => r.add(f)&&u().then(() => d[l](f, ...n))
        })({
            key: GOOGLE_MAPS_API_KEY,        // Tu API key
            v: "weekly",                     // Versi√≥n semanal (m√°s estable)
            libraries: ["places", "geometry"] // Librer√≠as necesarias para el demo
        });
    </script>

    <script type="module" src="./index.js"></script>
</body>

</html>